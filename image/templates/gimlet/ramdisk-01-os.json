{
    "dataset": {
        "name": "ramdisk",
        "output_snapshot": "os"
    },

    "steps": [
        { "t": "pkg_image_create" },
        { "t": "pkg_set_publisher", "with": "repo_redist",
            "publisher": "${repo_publisher}",
            "uri": "file://${repo_redist}" },
        { "t": "pkg_set_publisher", "with": "repo_url",
            "publisher": "${repo_publisher}",
            "uri": "${repo_url}" },
        { "t": "pkg_set_publisher",
            "publisher": "helios-dev",
            "uri": "https://pkg.oxide.computer/helios/${relver}/dev/" },
        { "t": "pkg_set_publisher", "with": "repo_redist",
            "publisher": "helios-netdev",
            "uri": "https://pkg.oxide.computer/helios/${relver}/netdev/" },

        { "t": "pkg_change_variant", "variant": "opensolaris.zone",
            "value": "global" },
        { "t": "pkg_change_variant", "variant": "opensolaris.imagetype",
            "value": "partial" },
        { "t": "pkg_change_variant", "with": "debug_variant",
                "variant": "debug.illumos", "value": "true" },

        { "t": "pkg_change_facet", "facet": "openssl.10",
            "value": "false" },
        { "t": "pkg_change_facet", "facet": "doc",
            "value": "false", "without": "recovery" },
        { "t": "pkg_change_facet", "facet": "doc.man",
            "value": "false", "without": "recovery" },

        { "t": "pkg_install", "pkgs": [
            "/developer/debug/mdb",
            "/system/kernel/dtrace/providers",
            "/system/network",
            "/system/microcode/oxide",

            "/driver/network/cxgbe",
            "/driver/network/e1000g",
            "/driver/network/igb",
            "/driver/network/ixgbe",
            "/driver/network/rge",

            "/driver/storage/nvme",

            "/developer/macro/cpp",
            "/developer/object-file",

            "/system/library/gcc-runtime",
            "/system/library/g++-runtime",
            "/developer/linker",
            "/diagnostic/diskinfo",
            "/diagnostic/pci",
            "/diagnostic/cpu-counters",
            "/system/data/hardware-registry",
            "/system/extended-system-utilities",
            "/web/curl",
            "/text/column",
            "/text/less",
            "/text/looker",
            "/ooce/util/jq",
            "/system/watch",
            "/editor/vim",
            "/terminal/resize",
            "/system/data/urxvt-terminfo",
            "/network/netcat",
            "/network/rsync",
            "/network/snoop",
            "/compress/gzip",
            "/locale/en",
            "/system/network/routing",
            "/driver/cpu/amd/zen",
            "/driver/gpio/amd/zen",
            "/system/gpio",
            "/system/bhyve",
            "/system/library/bhyve",
            "/service/network/chrony",

            "/driver/misc/tofino",
            "/library/expat",
            "/system/library/pcap",

            "/network/dns/bind",
            "/network/openssh-server"
        ] },

        { "t": "pkg_install", "without": "recovery", "pkgs": [
            "/system/man"
        ] },

        { "t": "pkg_install", "with": "omicron1", "pkgs": [
            "/library/libxmlsec1",
            "/ooce/library/postgresql-13",
            "/system/zones/brand/omicron1"
        ] },

        { "t": "pkg_install", "with": "optever", "pkgs": [
            "/driver/network/opte@${optever}"
        ] },

        { "t": "pkg_install", "with": "mfg", "pkgs": [
            "/driver/developer/amd/zen"
        ] },

        { "t": "pkg_install", "with": "compliance", "pkgs": [
            "/driver/developer/amd/zen",
            "/developer/debug/humility"
        ] },

        { "t": "pkg_install", "with": "stress", "pkgs": [
            "/ooce/util/stress-ng",
            "/system/test/fio"
        ] }
    ]
}
